<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
	<record id="freight_management_sale_order_form_view" model="ir.ui.view">
        <field name="name">freight_management.sale.order.form.view</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='note_group']/group[@name='sale_total']" position="inside">
                <field name="currency_name" invisible="1"/>
                <field name="usd_total_price" attrs="{'invisible':[('currency_name','!=','AED')]}"/>
                <field name="aed_total_price" attrs="{'invisible':[('currency_name','!=','USD')]}"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="contact_id" />
                <field name="customer_representative_id"/>
                <field name="freight_request_id" invisible="1"/>
            </xpath>
            <xpath expr="//group[@name='sale_info']" position="after">
                <group name = 'freight_note' string="Freight Note">
                    <field name="freight_note" placeholder="Freight Note"/>
                </group>
            </xpath>
            <xpath expr="//field[@name='order_line']/tree/field[@name='product_id']" position="before">
                <field name="visible_in_report"/>
            </xpath>
 
            <xpath expr="//field[@name='order_line']/tree" position="attributes">
                <attribute name="section-subtotal-data-field">price_subtotal</attribute>
            </xpath>


<!--            <xpath expr="//page/field[@name='order_line']" position="attributes">-->
<!--               <attribute name="attrs">{'readonly': ['|', ('freight_request_id', '!=', False), ('state', 'in', ('done','cancel'))]}</attribute>-->
<!--            </xpath>-->

            <xpath expr="//page/field[@name='order_line']/tree/field[@name='price_unit']" position="attributes">
               <attribute name="attrs">{'readonly': ['|', ('parent.freight_request_id', '!=', False), ('qty_invoiced', '&gt;', 0)]}</attribute>
            </xpath>

            <xpath expr="//page/field[@name='order_line']/tree/field[@name='tax_id']" position="attributes">
               <attribute name="attrs">{'readonly': ['|', ('parent.freight_request_id', '!=', False), ('qty_invoiced', '&gt;', 0)]}</attribute>
            </xpath>

            <xpath expr="//page/field[@name='order_line']/tree/field[@name='product_id']" position="attributes">
               <attribute name="attrs">{'readonly': ['|', ('parent.freight_request_id', '!=', False), ('product_updatable', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//page/field[@name='order_line']/tree/field[@name='product_uom_qty']" position="attributes">
               <attribute name="attrs">{'readonly': [('parent.freight_request_id', '!=', False)]}</attribute>
            </xpath>

            <xpath expr="//page/field[@name='order_line']/tree/field[@name='discount']" position="attributes">
               <attribute name="attrs">{'readonly': [('parent.freight_request_id', '!=', False)]}</attribute>
            </xpath>

        </field>
    </record>
</odoo>
