<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="view_move_form_inherit" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='operating_unit_id']" position="attributes">
                <attribute name="string">Branch</attribute>
            </xpath>
            <xpath expr="//field[@name='payment_reference']" position="after">
                <field name="custom_payment_reference" force_save="1" />
                <field name="payment_hold" />
            </xpath>
            <xpath expr="//field[@name='payment_reference']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='line_ids']/tree/field[@name='operating_unit_id']" position="attributes">
                <attribute name="string">Branch</attribute>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='name']" position="before">
                <field name="operating_unit_id" />
                <field name="memo" />
                <field name="code_journal" />
            </xpath>
            <xpath expr="//field[@name='partner_bank_id']" position="attributes">
                <attribute name="string">Bill Bank</attribute>
            </xpath>
            <xpath expr="//field[@name='state']" position="attributes">
                <attribute name="statusbar_visible">draft,create,posted</attribute>
            </xpath>
            <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="attrs">{'readonly': [('state', '!=', 'create')]}</attribute>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="action_create" class="oe_highlight" string="Create" type="object" groups="sales_team.group_sale_salesman"
                attrs="{'invisible': [('state', '!=', 'draft')]}"/>
            </xpath>
            <xpath expr="//header/button[1]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', ('state', '!=', 'create'), ('auto_post', '=', True), ('move_type', '!=', 'entry')]}</attribute>
            </xpath>
            <xpath expr="//header/button[2]" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', ('state', '!=', 'create'), ('auto_post', '=', True), ('move_type', '=', 'entry')]}</attribute>
            </xpath>
            <xpath expr="//button[@id='account_invoice_payment_btn']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', '|', '|',('payment_hold', '=', True) , ('state', '!=', 'posted'), ('payment_state', 'not in', ('partial', 'not_paid')), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt')), ('authorized_transaction_ids', '!=', [])]}</attribute>
            </xpath>
            <xpath expr="//div[@name='journal_div']" position="replace">
                <div name="journal_div" class="d-flex" invisible="context.get('default_journal_id') and context.get('move_type', 'entry') != 'entry'">
                    <field name="journal_id"
                        groups="account.group_account_readonly"
                        options="{'no_create': True}"
                        attrs="{'readonly': [('posted_before', '=', True)]}"/>
                </div>
                <field name="currency_id"
                        groups="base.group_multi_currency"
                        attrs="{'readonly': [('posted_before', '=', True)]}"/>
            </xpath>
        </field>
    </record>
    <record id="view_move_line_form_inherit" model="ir.ui.view">
        <field name="name">account.move.line.form.inherit</field>
        <field name="model">account.move.line</field>
        <field name="inherit_id" ref="account.view_move_line_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='operating_unit_id']" position="attributes">
                <attribute name="string">Branch</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_move_line_tree_inherit" model="ir.ui.view">
        <field name="name">account.move.line.tree.inherit</field>
        <field name="model">account.move.line</field>
        <field name="inherit_id" ref="account.view_move_line_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='operating_unit_id']" position="attributes">
                <attribute name="string">Branch</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_invoice_tree_inherit" model="ir.ui.view">
        <field name="name">account.invoice.tree.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='operating_unit_id']" position="attributes">
                <attribute name="string">Branch</attribute>
            </xpath>
        </field>
    </record>
</odoo>
